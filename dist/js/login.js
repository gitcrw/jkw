"use strict";!function(){var o=0;$(".tab_login span").click(function(){$(this).addClass("active").siblings().removeClass("active"),$(".info>div").eq($(this).index()).css("display","block").siblings().css("display","none"),o=$(this).index()});var e=new GVerify({id:"codepic",type:"blend"});function c(){var o=$("#code").val();o?e.validate(o)?($("#code").css("border","1px solid #ddd"),$(".codepic_info").html(""),$("#code").attr("ok","yes")):($("#code").css("border","1px solid #c33"),$(".codepic_info").html("图形验证码错误"),$("#code").attr("ok","no")):($("#code").css("border","1px solid #c33"),$(".codepic_info").html("请输入图形验证码"),$("#code").attr("ok","no"))}function i(o,e){$(o).val()?/^1[3-9]\d{9}$/.test($(o).val())?($(o).css("border","1px solid #ddd"),$(e).html("")):($(o).css("border","1px solid #c33"),$(e).html("请输入正确手机号")):($(o).css("border","1px solid #c33"),$(e).html("手机号不能为空"))}function n(){$("#phonecode").val()?($("#phonecode").css("border","1px solid #ddd"),$(".code_info").html("")):($("#phonecode").css("border","1px solid #c33"),$(".code_info").html("请输入短信验证码"))}$("#code").blur(function(){c()}),$("#code").keyup(function(){c()}),$("#phone").blur(function(){i("#phone",".phone_info")}),$("#phone").keyup(function(){i("#phone",".phone_info")}),$("#phonecode").blur(function(){n()}),$("#phonecode").keyup(function(){n()});var d="",p=!0;function t(){$("#phone2").val()?($("#phone2").css("border","1px solid #ddd"),$(".phone_info2").html("")):($("#phone2").css("border","1px solid #c33"),$(".phone_info2").html("用户名不能为空"))}function l(){$("#pwd2").val()?($("#pwd2").css("border","1px solid #ddd"),$(".pwd_info2").html("")):($("#pwd2").css("border","1px solid #c33"),$(".pwd_info2").html("密码不能为空"))}function s(){$("#agree").is(":checked")||alert("请同意条款")}function a(o,e){h("user",$(o).val(),1),h("pwd",$(e).val(),1)}function h(o,e,n){var c=new Date;c.setDate(c.getDate()+n),document.cookie=o+"="+e+";expires="+c+";path=/"}$("#getcode").click(function(){if(c(),i("#phone",".phone_info"),""==$(".phone_info").html()&&""==$(".codepic_info").html()){if(p){$.ajax({type:"post",url:"../api/duanxin.php",data:{userphone:$("#phone").val()},success:function(o){d=o}}),$("#getcode").html("重试60");var e=setInterval(function(){if(n<=1)n=0,$("#getcode").html("获取验证码"),clearInterval(e),p=!0;else{var o="重试"+--n;$("#getcode").html(o)}},1e3),n=60}p=!1}}),$("#phone2").on("blur keyup",function(){t()}),$("#pwd2").on("blur keyup",function(){l()}),$("#loginbtn").click(function(){"1"==o?(t(),l(),s(),""==$(".phone_info2").html()&&""==$(".pwd_info2").html()&&$("#agree").is(":checked")&&$.ajax({type:"post",url:"../api/login.php",data:{password:$("#pwd2").val(),phone:$("#phone2").val()},success:function(o){"yes"==o?(alert("登录成功"),a("#phone2","#pwd2"),window.location.replace("index.html")):$(".pwd_info2").html("账号或密码错误")}})):(c(),i("#phone",".phone_info"),n(),s(),""==$(".phone_info").html()&&""==$(".codepic_info").html()&&""==$(".code_info").html()&&$("#agree").is(":checked")&&(d==$("#phonecode").val()?$.ajax({type:"post",url:"../api/checkphone.php",data:{phone:$("#phone").val()},success:function(o){"no"==o?(alert("登录成功"),a("#phone2","#pwd2"),window.location.replace("index.html")):($.ajax({type:"post",url:"../api/adduser.php",data:{phone:$("#phone").val(),password:123456},success:function(){alert("登录成功"),a("#phone2","#pwd2"),window.location.replace("index.html")}}),$.ajax({type:"post",url:"../api/duanxin1.php",data:{phone:$("#phone").val()},success:function(){}}))}}):$(".code_info").html("短信验证码错误")))})}();